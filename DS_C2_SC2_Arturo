{"cells":[{"cell_type":"code","source":["# Numpy and pandas challenge.\n","#AUTHOR: ARTURO ORTIZ OLIVARES\n","\n","#IMPORTING THE LIBRARY PANDAS\n","import pandas as pd\n","\n","#DECLARE VARIABLE\n","file = 'country_vaccinations.csv'\n","\n","\n","#A.Extraer la información del archivo.\n","# READ AND PARSE DATES\n","df_General = pd.read_csv(f'{file}', sep = ',', encoding = 'ISO-8859-1', low_memory = False, parse_dates = ['date'])\n","print()\n","\n","# B. Mostrar la estructura y tipos de datos de cada columna\n","atributes = df_General.info()\n","print(atributes)\n","print()\n","\n","#C. Determinar la cantidad de vacunas aplicadas de cada compañía\n","#DELET DUPLICATES OF THE COLUMN VACCINES to_list()\n","lst_vaccines = df_General['vaccines'].drop_duplicates().to_list()\n","#ITERATE OVER\n","for vaccines in lst_vaccines:\n","  vc = df_General[df_General['vaccines'].str.contains(vaccines)]['vaccines'].astype(str)\n","# NUMBER OF VACCINES BY BRAND\n","  size = len(vc)\n","  print(vaccines, ': ', size)\n","print()\n","\n","# D. Obtener la cantidad de vacunas aplicadas en todo el mundo\n","#SUM OF THE COLUM daily_vaccinations\n","total_vaccines = df_General['daily_vaccinations'].sum()\n","print('cantidad de vacunas aplicadas en todo el mundo: ', int(total_vaccines))\n","print()\n","\n","# E. Calcular el promedio de vacunas aplicadas por país\n","#DELET DUPLICATES ON THE COLUMN CONTRY AND COUNT\n","countries = df_General['country'].drop_duplicates().count()\n","#DIVIDE TOTAL / COUNT COUNTRIES\n","average = total_vaccines/countries\n","print('Promedio de vacunas por pais: ', average.round(2))\n","print()\n","\n","\n","#F. Determinar la cantidad de vacunas aplicadas el día 29/01/21 en todo el mundo\n","# PERSE TO_DATETIME\n","specific_day = pd.to_datetime('29/01/2021')\n","#match date column to specific date and add\n","vaccines_day= df_General[df_General['date']==specific_day]['daily_vaccinations'].sum()\n","print('cantidad de vacunas aplicadas el día ', specific_day, int(vaccines_day))\n","print()\n","\n","# G. Crear un dataframe nuevo denominado conDiferencias\n","#CREATE A COPY FROM GENERAL DATAFRAME\n","df_conDiferencias = df_General.copy()\n","#ADD COLUMN (Diferencias)\n","df_conDiferencias['Diferencias'] = df_conDiferencias['daily_vaccinations'] - df_conDiferencias['daily_vaccinations_raw']\n","\n","# H. Obtener el periodo de tiempo entre el registro con fecha más reciente y el registro con fecha más antigua\n","minimum_date = df_General['date'].min()\n","maximum_date = df_General['date'].max()\n","period = maximum_date-minimum_date\n","print('periodo de tiempo entre el registro con fecha más reciente y el registro con fecha más antigua: ', period)\n","print()\n","\n","# I. Crear un dataframe nuevo denominado conCantidad\n","#CREATE A COPY FROM GENERAL DATAFRAME\n","df_conCantidad = df_General.copy()\n","#ADD COLUMN canVac, Lambda: is using in the creation of derivate columns, split: separte by a character\n","df_conCantidad['canVac'] = df_conCantidad.apply(lambda row: len(str(row['vaccines']).split(',')), axis=1)\n","\n","# J. Generar un dataframe denominado antes20\n","#set the deadline\n","deadline = pd.to_datetime('20/12/2020')\n","#condition\n","df_antes20 = df_General[df_General['date']<deadline]\n","\n","# K. Obtener un dataframe denominado pfizer\n","#search in the column vaccines all that contains Pfizer\n","df_pfizer = df_General[df_General['vaccines'].str.contains('Pfizer')]\n","#print the number of records\n","print('Cantidad de registros donde se utilizo la vacuna Pfizer: ', len(df_pfizer))\n","print()\n","\n","#l. Almacenar los dataframes generados (conDiferencias, conCantidad, antes20 y pfizer) en un archivo de Excel denominado resultadosReto.xlsx\n","with pd.ExcelWriter(f'resultadosReto.xlsx', engine = 'openpyxl') as writer:\n","            df_conDiferencias.to_excel(excel_writer=writer, sheet_name = 'ConDiferencias', index = False,\n","                            header = True, startrow = 1, startcol = 1)\n","            df_conCantidad.to_excel(excel_writer=writer, sheet_name = 'ConCantidad', index = False,\n","                            header = True, startrow = 1, startcol = 1)\n","            df_antes20.to_excel(excel_writer=writer, sheet_name = 'Antes20', index = False,\n","                            header = True, startrow = 1, startcol = 1)\n","            df_pfizer.to_excel(excel_writer=writer, sheet_name = 'Pfizer', index = False,\n","                            header = True, startrow = 1, startcol = 1)\n","\n"],"metadata":{"id":"V6PblBx12Yl9","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1734715368313,"user_tz":360,"elapsed":92871,"user":{"displayName":"ARTURO ORTIZ OLIVARES","userId":"04986222201056634288"}},"outputId":"fec164d8-e8b6-4ddb-db91-acd225a68f80"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 86512 entries, 0 to 86511\n","Data columns (total 15 columns):\n"," #   Column                               Non-Null Count  Dtype         \n","---  ------                               --------------  -----         \n"," 0   country                              86512 non-null  object        \n"," 1   iso_code                             86512 non-null  object        \n"," 2   date                                 86512 non-null  datetime64[ns]\n"," 3   total_vaccinations                   43607 non-null  float64       \n"," 4   people_vaccinated                    41294 non-null  float64       \n"," 5   people_fully_vaccinated              38802 non-null  float64       \n"," 6   daily_vaccinations_raw               35362 non-null  float64       \n"," 7   daily_vaccinations                   86213 non-null  float64       \n"," 8   total_vaccinations_per_hundred       43607 non-null  float64       \n"," 9   people_vaccinated_per_hundred        41294 non-null  float64       \n"," 10  people_fully_vaccinated_per_hundred  38802 non-null  float64       \n"," 11  daily_vaccinations_per_million       86213 non-null  float64       \n"," 12  vaccines                             86512 non-null  object        \n"," 13  source_name                          86512 non-null  object        \n"," 14  source_website                       86512 non-null  object        \n","dtypes: datetime64[ns](1), float64(9), object(5)\n","memory usage: 9.9+ MB\n","None\n","\n","Johnson&Johnson, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing :  5392\n","Oxford/AstraZeneca, Pfizer/BioNTech, Sinovac, Sputnik V :  2451\n","Oxford/AstraZeneca, Sinopharm/Beijing, Sinovac, Sputnik V :  1158\n","Moderna, Oxford/AstraZeneca, Pfizer/BioNTech :  26127\n","Oxford/AstraZeneca :  71331\n","Oxford/AstraZeneca, Pfizer/BioNTech :  53748\n","Oxford/AstraZeneca, Pfizer/BioNTech, Sputnik V :  1626\n","CanSino, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sputnik V :  456\n","Moderna, Oxford/AstraZeneca, Sinopharm/Beijing, Sinovac, Sputnik V :  348\n","Pfizer/BioNTech :  64193\n","Johnson&Johnson, Moderna, Novavax, Oxford/AstraZeneca, Pfizer/BioNTech :  4455\n","Johnson&Johnson, Oxford/AstraZeneca, Pfizer/BioNTech :  7676\n","Johnson&Johnson, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sputnik Light, Sputnik V :  456\n","Johnson&Johnson, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sinovac :  1934\n","Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing :  21158\n","Sinopharm/Beijing, Sputnik V :  8767\n","Johnson&Johnson, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech :  14844\n","Johnson&Johnson, Oxford/AstraZeneca, Pfizer/BioNTech, Sinovac :  752\n","Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing :  8475\n","Johnson&Johnson, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sputnik V :  1614\n","Moderna, Pfizer/BioNTech :  4636\n","Covaxin, Johnson&Johnson, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinovac :  362\n","Johnson&Johnson, Oxford/AstraZeneca :  12991\n","Johnson&Johnson, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing :  4882\n","Johnson&Johnson, Oxford/AstraZeneca, Sinopharm/Beijing :  3979\n","Sinopharm/Beijing :  34638\n","Johnson&Johnson, Oxford/AstraZeneca, Sinopharm/Beijing, Sinovac :  1495\n","Covaxin, Oxford/AstraZeneca :  1505\n","CanSino, Oxford/AstraZeneca, Pfizer/BioNTech, Sinovac :  885\n","CanSino, Sinopharm/Beijing, Sinopharm/Wuhan, Sinovac, ZF2001 :  470\n","Johnson&Johnson, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinovac :  1963\n","Covaxin, Oxford/AstraZeneca, Sinopharm/Beijing :  748\n","Moderna, Oxford/AstraZeneca, Sinopharm/Beijing, Sputnik V :  344\n","Abdala, Soberana Plus, Soberana02 :  320\n","Johnson&Johnson, Moderna, Pfizer/BioNTech :  1873\n","Johnson&Johnson, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sinovac, Sputnik V :  1127\n","Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sinovac :  7767\n","Covaxin, Johnson&Johnson, Oxford/AstraZeneca, Sinopharm/Beijing, Sinovac :  354\n","Johnson&Johnson, Pfizer/BioNTech :  1055\n","Pfizer/BioNTech, Sinopharm/Beijing, Sputnik V :  6561\n","Oxford/AstraZeneca, Sputnik V :  804\n","Moderna :  37417\n","Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sputnik V :  785\n","Oxford/AstraZeneca, Sinopharm/Beijing :  8498\n","Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sputnik V :  2544\n","Johnson&Johnson, Moderna :  21903\n","Johnson&Johnson, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sputnik V :  391\n","Pfizer/BioNTech, Sinovac :  7834\n","Johnson&Johnson, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sputnik V :  880\n","Covaxin, Oxford/AstraZeneca, Sputnik V :  439\n","Johnson&Johnson, Moderna, Novavax, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sinovac :  442\n","COVIran Barekat, Covaxin, FAKHRAVAC, Oxford/AstraZeneca, Razi Cov Pars, Sinopharm/Beijing, Soberana02, SpikoGen, Sputnik V :  415\n","Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sputnik V :  6199\n","QazVac, Sinopharm/Beijing, Sputnik V :  613\n","Johnson&Johnson, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sinovac, Sputnik Light, Sputnik V :  377\n","Johnson&Johnson, Moderna, Novavax, Pfizer/BioNTech :  480\n","Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sinovac, Sputnik V :  3417\n","Pfizer/BioNTech, Sinopharm/Beijing :  22616\n","CanSino, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sinovac :  399\n","CanSino, Johnson&Johnson, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinovac, Sputnik V :  461\n","Abdala, Johnson&Johnson, Oxford/AstraZeneca, Pfizer/BioNTech, Soberana02, Sputnik Light, Sputnik V :  390\n","Oxford/AstraZeneca, Pfizer/BioNTech, Sinovac :  6994\n","CanSino, Covaxin, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sinovac, Sputnik V :  402\n","Johnson&Johnson, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sinovac, Sputnik Light, Sputnik V :  755\n","Covaxin, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sinovac, Sputnik V :  799\n","EpiVacCorona, Sputnik V :  470\n","Johnson&Johnson, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sinovac, Sputnik V :  751\n","Pfizer/BioNTech, Sputnik V :  2013\n","Oxford/AstraZeneca, Sinopharm/Beijing, Sputnik V :  778\n","Moderna, Pfizer/BioNTech, Sinopharm/Beijing, Sinovac :  454\n","Johnson&Johnson, Moderna, Novavax, Oxford/AstraZeneca, Pfizer/BioNTech, Sputnik V :  449\n","Johnson&Johnson, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sinovac :  1867\n","Johnson&Johnson, Oxford/AstraZeneca, Sinopharm/Beijing, Sinovac, Sputnik Light, Sputnik V :  388\n","Medigen, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech :  374\n","Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinovac, Sputnik V :  772\n","Johnson&Johnson, Pfizer/BioNTech, Sinopharm/Beijing :  228\n","Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sinovac :  3129\n","Pfizer/BioNTech, Sinovac, Turkovac :  441\n","EpiVacCorona, Oxford/AstraZeneca, QazVac, Sinopharm/Beijing, Sputnik V, ZF2001 :  190\n","Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sinopharm/Wuhan, Sputnik V :  449\n","Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinovac, Sputnik Light, Sputnik V, ZF2001 :  348\n","Abdala, Sinopharm/Beijing, Sinovac, Soberana02, Sputnik Light, Sputnik V :  402\n","Abdala, Moderna, Oxford/AstraZeneca, Pfizer/BioNTech, Sinopharm/Beijing, Sputnik V :  381\n","Johnson&Johnson, Oxford/AstraZeneca, Sinovac :  312\n","\n","cantidad de vacunas aplicadas en todo el mundo:  11320239871\n","\n","Promedio de vacunas por pais:  50763407.49\n","\n","cantidad de vacunas aplicadas el día  2021-01-29 00:00:00 4884052\n","\n","periodo de tiempo entre el registro con fecha más reciente y el registro con fecha más antigua:  482 days 00:00:00\n","\n"]},{"output_type":"stream","name":"stderr","text":["<ipython-input-4-b0847070d022>:49: UserWarning: Parsing dates in %d/%m/%Y format when dayfirst=False (the default) was specified. Pass `dayfirst=True` or specify a format to silence this warning.\n","  specific_day = pd.to_datetime('29/01/2021')\n","<ipython-input-4-b0847070d022>:76: UserWarning: Parsing dates in %d/%m/%Y format when dayfirst=False (the default) was specified. Pass `dayfirst=True` or specify a format to silence this warning.\n","  deadline = pd.to_datetime('20/12/2020')\n"]},{"output_type":"stream","name":"stdout","text":["Cantidad de registros donde se utilizo la vacuna Pfizer:  64193\n","\n"]}]}],"metadata":{"colab":{"provenance":[{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1734714300574}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}